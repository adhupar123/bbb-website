<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Simulator — BBB Project</title>

  <!-- Plotly -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>

  <!-- RDKit MinimalLib for SMILES descriptor calculation -->
  <script src="https://unpkg.com/@rdkit/rdkit/Code/MinimalLib/dist/RDKit_minimal.js"></script>

  <!-- You may still keep your global styles.css; the page also includes page-specific styles below -->
  <link rel="stylesheet" href="./styles.css">

  <style>
    /* Page-specific design inspired by your example About page */
    *{box-sizing:border-box}
    body{
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height:1.5;
      margin:0;
      color:#333;
      background: linear-gradient(180deg,#f5f7fb 0%, #eef2ff 100%);
    }
    header{
      background: linear-gradient(135deg,#667eea 0%, #764ba2 100%);
      color:white;
      padding:28px 20px;
      text-align:center;
      box-shadow: 0 2px 12px rgba(0,0,0,0.12);
    }
    header h1{ font-size:2.1rem; margin-bottom:6px; }
    header p{ opacity:0.92; margin-top:6px; }

    nav{
      background:#2c3e50;
      padding:10px 0;
      position:sticky;
      top:0;
      z-index:50;
      box-shadow:0 2px 8px rgba(0,0,0,0.12);
    }
    nav ul{ list-style:none; display:flex; justify-content:center; gap:22px; margin:0; padding:0; }
    nav a{ color:white; text-decoration:none; font-weight:600; padding:8px 12px; border-radius:6px; }
    nav a:hover{ background: rgba(255,255,255,0.08); }

    .container{ max-width:1200px; margin:28px auto; padding:0 20px; }

    .section{
      background:white;
      border-radius:14px;
      padding:24px;
      box-shadow: 0 6px 24px rgba(20,30,60,0.06);
      margin-bottom:28px;
    }

    .grid {
      display:grid;
      grid-template-columns:360px 1fr;
      gap:20px;
    }
    @media (max-width:980px){ .grid{ grid-template-columns:1fr } }

    .controls {
      display:flex;
      flex-direction:column;
      gap:12px;
    }
    label.small{ display:block; font-size:13px; color:#556; margin-bottom:6px; }
    select, input[type="number"], input[type="text"]{
      padding:8px 10px; border-radius:8px; border:1px solid #e6eef9; width:100%;
    }
    .slider-row{ margin-bottom:8px; }
    .slider-row label{ font-size:13px; color:#556; display:flex; justify-content:space-between; margin-bottom:6px; }
    input[type="range"]{ width:100%; }

    .actions{ display:flex; gap:10px; margin-top:8px; }
    .btn{ background:#667eea; color:white; padding:10px 14px; border-radius:10px; border:0; cursor:pointer; font-weight:700; }
    .btn.ghost{ background:transparent; border:2px solid #667eea; color:#333; font-weight:700; }

    .meta{
      display:flex; gap:12px; align-items:center; flex-wrap:wrap; font-size:14px; color:#333;
      margin-bottom:12px;
    }
    .meta strong{ color:#111; margin-left:6px; }

    #plot{ width:100%; height:460px; }

    .footer-note{ font-size:13px; color:#555; margin-top:12px; }
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.95);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>

<body>
  <div id="loading" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p style="margin-top: 20px; color: #667eea; font-weight: 600;">Loading RDKit chemistry library...</p>
  </div>

  <header>
    <h1>Interactive Simulator</h1>
    <p>Fick's Law diffusion model + LogBB prediction — Blood &amp; Brain concentration simulation</p>
  </header>

  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="about.html">About</a></li>
      <li><a href="simulate.html" style="background:rgba(255,255,255,0.08);">Simulator</a></li>
      <li><a href="viz.html">Visualizations</a></li>
      <li><a href="Final Project Code.html">Full Analysis</a></li>
    </ul>
  </nav>

  <div class="container">
    <div class="section">
      <h2 style="color:#667eea; margin-top:0; margin-bottom:6px;">Fick's Law Simulation & LogBB</h2>
      <p style="color:#555; margin-top:0; margin-bottom:16px;">Choose a drug or adjust molecular descriptors to see the predicted LogBB and the resulting two-compartment diffusion simulation (blood ↔ brain). If experimental LogBB is present for the drug, the experimental curve is shown as well.</p>

      <div class="grid">
        <!-- controls -->
        <div class="controls">
          <label class="small">Drug</label>
          <select id="drug-select"><option value="">Loading...</option></select>

          <div class="slider-row">
            <label>MolLogP <span id="MolLogP_val" style="font-weight:700"></span></label>
            <input id="MolLogP" type="range" min="-5" max="10" step="0.01" value="1.0">
          </div>

          <div class="slider-row">
            <label>MolWt <span id="MolWt_val" style="font-weight:700"></span></label>
            <input id="MolWt" type="range" min="50" max="1000" step="0.1" value="350">
          </div>

          <div class="slider-row">
            <label>TPSA <span id="TPSA_val" style="font-weight:700"></span></label>
            <input id="TPSA" type="range" min="0" max="300" step="0.1" value="70">
          </div>

          <div class="slider-row">
            <label>Formal Charge (FC) <span id="FC_val" style="font-weight:700"></span></label>
            <input id="FC" type="range" min="-5" max="5" step="1" value="0">
          </div>

          <div class="slider-row">
            <label>Aromatic Rings <span id="Aromatic_val" style="font-weight:700"></span></label>
            <input id="Aromatic" type="range" min="0" max="10" step="1" value="1">
          </div>

          <div class="slider-row">
            <label>Heavy Atoms <span id="Heavy_val" style="font-weight:700"></span></label>
            <input id="Heavy" type="range" min="0" max="200" step="1" value="30">
          </div>

          <div style="display:flex; gap:12px; margin-top:10px;">
            <div style="flex:1">
              <label class="small">P<sub>eff</sub> (partition eff)</label>
              <input id="P_eff" type="number" step="0.01" value="0.15">
            </div>
            <div style="width:120px">
              <label class="small">Time (h)</label>
              <input id="Tmax" type="number" step="1" value="24">
            </div>
          </div>

          <div class="actions">
            <button id="runBtn" class="btn">Run Simulation</button>
            <button id="resetBtn" class="btn ghost">Reset</button>
          </div>

          <div style="margin-top:12px; color:#444; font-size:14px;">
            <div class="meta">Model LogBB: <strong id="model_logbb">—</strong></div>
            <div class="meta">Experimental LogBB: <strong id="exp_logbb">—</strong></div>
          </div>

          <div class="footer-note">Data: <code>B3DB_regression.tsv</code>. Descriptors computed from SMILES using RDKit. Regression computed client-side.</div>
        </div>

        <!-- plot -->
        <div>
          <div id="plot"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="./simulate.js"></script>
</body>
</html>
