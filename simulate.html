<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blood-Brain Barrier Drug Permeability Simulator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }
        
        h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .control-group {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #e9ecef;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 600;
            font-size: 0.95em;
        }
        
        .control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .value-display {
            text-align: right;
            color: #667eea;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .results {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
        }
        
        .result-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: white;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .result-label {
            font-weight: 600;
            color: #495057;
        }
        
        .result-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .interpretation {
            margin-top: 20px;
            padding: 20px;
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            border-radius: 5px;
        }
        
        .interpretation h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .interpretation p {
            color: #856404;
            line-height: 1.6;
        }
        
        .info-box {
            background: #e7f3ff;
            border-left: 5px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        
        .info-box h3 {
            color: #1976D2;
            margin-bottom: 8px;
        }
        
        .info-box p {
            color: #0d47a1;
            line-height: 1.5;
            font-size: 0.95em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ§  Blood-Brain Barrier Drug Permeability Simulator</h1>
        <p class="subtitle">Predict drug permeability across the BBB using molecular descriptors</p>
        
        <div class="info-box">
            <h3>About the Model</h3>
            <p>This simulator uses a multiple linear regression model trained on ~1000 drugs with known BBB permeability. 
            The LogBB value represents the logarithm of the brain-to-blood concentration ratio. Values > 0 indicate 
            the drug can effectively cross the BBB.</p>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label for="molLogP">Lipophilicity (MolLogP)</label>
                <input type="range" id="molLogP" min="-2" max="7" step="0.1" value="2.0">
                <div class="value-display"><span id="molLogP-val">2.0</span></div>
            </div>
            
            <div class="control-group">
                <label for="molWt">Molecular Weight (Da)</label>
                <input type="range" id="molWt" min="50" max="900" step="5" value="350">
                <div class="value-display"><span id="molWt-val">350</span> Da</div>
            </div>
            
            <div class="control-group">
                <label for="tpsa">Topological Polar Surface Area (Å²)</label>
                <input type="range" id="tpsa" min="0" max="220" step="1" value="70">
                <div class="value-display"><span id="tpsa-val">70</span> Å²</div>
            </div>
            
            <div class="control-group">
                <label for="fc">Formal Charge</label>
                <input type="range" id="fc" min="-3" max="3" step="1" value="0">
                <div class="value-display"><span id="fc-val">0</span></div>
            </div>
            
            <div class="control-group">
                <label for="aromatic">Aromatic Rings</label>
                <input type="range" id="aromatic" min="0" max="10" step="1" value="1">
                <div class="value-display"><span id="aromatic-val">1</span></div>
            </div>
            
            <div class="control-group">
                <label for="heavy">Heavy Atoms</label>
                <input type="range" id="heavy" min="5" max="100" step="1" value="30">
                <div class="value-display"><span id="heavy-val">30</span></div>
            </div>
        </div>
        
        <div class="results">
            <div class="result-item">
                <span class="result-label">Predicted LogBB Value:</span>
                <span class="result-value" id="logbb-result">0.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">Brain/Blood Concentration Ratio:</span>
                <span class="result-value" id="ratio-result">1.00</span>
            </div>
            <div class="result-item">
                <span class="result-label">BBB Permeability:</span>
                <span class="result-value" id="permeability-result" style="color: #28a745;">Crosses BBB</span>
            </div>
        </div>
        
        <div class="interpretation" id="interpretation">
            <h3>ðŸ“Š Interpretation</h3>
            <p id="interpretation-text"></p>
        </div>
        
        <div class="chart-container">
            <canvas id="concentrationChart"></canvas>
        </div>
    </div>
    
    <script>
        // Regression coefficients from the model
        const coefficients = {
            intercept: 0.2407,
            MolLogP: -0.0115,
            MolWt: -0.0013,
            TPSA: -0.0133,
            FC: 0.0172,
            AromaticRings: -0.1323,
            HeavyAtoms: 0.0512
        };
        
        // Get all slider elements
        const sliders = {
            molLogP: document.getElementById('molLogP'),
            molWt: document.getElementById('molWt'),
            tpsa: document.getElementById('tpsa'),
            fc: document.getElementById('fc'),
            aromatic: document.getElementById('aromatic'),
            heavy: document.getElementById('heavy')
        };
        
        // Initialize chart
        const ctx = document.getElementById('concentrationChart').getContext('2d');
        let chart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['Blood', 'Brain'],
                datasets: [{
                    label: 'Relative Concentration',
                    data: [1.0, 1.0],
                    backgroundColor: [
                        'rgba(220, 53, 69, 0.8)',
                        'rgba(102, 126, 234, 0.8)'
                    ],
                    borderColor: [
                        'rgba(220, 53, 69, 1)',
                        'rgba(102, 126, 234, 1)'
                    ],
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: 'Drug Concentration Distribution',
                        font: {
                            size: 18
                        }
                    },
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Relative Concentration'
                        }
                    }
                }
            }
        });
        
        function calculateLogBB() {
            const values = {
                molLogP: parseFloat(sliders.molLogP.value),
                molWt: parseFloat(sliders.molWt.value),
                tpsa: parseFloat(sliders.tpsa.value),
                fc: parseFloat(sliders.fc.value),
                aromatic: parseFloat(sliders.aromatic.value),
                heavy: parseFloat(sliders.heavy.value)
            };
            
            // Update displays
            document.getElementById('molLogP-val').textContent = values.molLogP.toFixed(1);
            document.getElementById('molWt-val').textContent = values.molWt;
            document.getElementById('tpsa-val').textContent = values.tpsa;
            document.getElementById('fc-val').textContent = values.fc;
            document.getElementById('aromatic-val').textContent = values.aromatic;
            document.getElementById('heavy-val').textContent = values.heavy;
            
            // Calculate LogBB using the regression equation
            const logBB = coefficients.intercept +
                         (coefficients.MolLogP * values.molLogP) +
                         (coefficients.MolWt * values.molWt) +
                         (coefficients.TPSA * values.tpsa) +
                         (coefficients.FC * values.fc) +
                         (coefficients.AromaticRings * values.aromatic) +
                         (coefficients.HeavyAtoms * values.heavy);
            
            const ratio = Math.pow(10, logBB);
            
            // Update results
            document.getElementById('logbb-result').textContent = logBB.toFixed(3);
            document.getElementById('ratio-result').textContent = ratio.toFixed(3);
            
            const permeabilityEl = document.getElementById('permeability-result');
            if (logBB > 0) {
                permeabilityEl.textContent = 'Crosses BBB âœ“';
                permeabilityEl.style.color = '#28a745';
            } else if (logBB > -0.5) {
                permeabilityEl.textContent = 'Moderate Permeability';
                permeabilityEl.style.color = '#ffc107';
            } else {
                permeabilityEl.textContent = 'Poor BBB Penetration âœ—';
                permeabilityEl.style.color = '#dc3545';
            }
            
            // Update interpretation
            let interpretation = '';
            if (logBB > 0) {
                interpretation = `This drug shows good BBB permeability with a LogBB of ${logBB.toFixed(3)}. 
                The brain concentration is expected to be ${ratio.toFixed(2)} times the blood concentration. 
                This suggests the drug can effectively reach the central nervous system.`;
            } else if (logBB > -0.5) {
                interpretation = `This drug shows moderate BBB permeability with a LogBB of ${logBB.toFixed(3)}. 
                The brain concentration is ${(ratio * 100).toFixed(1)}% of the blood concentration. 
                Some therapeutic effect in the CNS may be possible, but optimization could improve delivery.`;
            } else {
                interpretation = `This drug shows poor BBB permeability with a LogBB of ${logBB.toFixed(3)}. 
                The brain concentration is only ${(ratio * 100).toFixed(1)}% of the blood concentration. 
                Significant structural modifications would be needed for CNS drug development.`;
            }
            
            document.getElementById('interpretation-text').textContent = interpretation;
            
            // Update chart
            chart.data.datasets[0].data = [1.0, ratio];
            chart.update();
        }
        
        // Add event listeners to all sliders
        Object.values(sliders).forEach(slider => {
            slider.addEventListener('input', calculateLogBB);
        });
        
        // Initial calculation
        calculateLogBB();
    </script>
</body>
</html>
